<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>KAUN BANEGA LOTUS LAP RAMANUJAN</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body class="bg index">
  <div class="overlay">
    <header class="hero">
      <h1 class="title">KAUN BANEGA LOTUS LAP RAMANUJAN</h1>
      <div class="logos" role="img" aria-label="Logos">
        <img src="llps 1.jpeg" alt="Lotus Lap Public School logo" class="logo logo-left">
        <img src="llramanujan.png" alt="Game logo" class="logo logo-center">
        <img src="sr.png" alt="Srinivasa Ramanujan" class="logo logo-right">
      </div>
      
      <div class="start-wrap">
        <button id="startBtn" class="btn start-btn">START</button>
        <div class="audio-control">
          <button id="bgToggle" class="nav-btn">ðŸ”Š</button>
        </div>
      </div>
    </header>
  </div>
  <!-- Background audio for home page only. Place a file named `home.mp3` in the project root. -->
  <audio id="bgAudio" src="home.mp3" loop preload="auto" autoplay playsinline></audio>
  <script>
    const startBtn = document.getElementById('startBtn');
    const bg = document.getElementById('bgAudio');
    const toggle = document.getElementById('bgToggle');

    // ensure audio is unmuted and at full volume, then try to play.
    function tryPlay(){
      if(!bg) return;
      try{ bg.muted = false; bg.volume = 1.0; }catch(e){}
      bg.play().then(()=>{
        toggle.textContent = 'ðŸ”Š';
      }).catch(()=>{
        // will wait for user action
        toggle.textContent = 'ðŸ”ˆ';
      });
    }

    // Start playback when the user first interacts with the page
    document.addEventListener('click', function oncePlay(){ tryPlay(); document.removeEventListener('click', oncePlay); }, {capture:true});

    // Toggle audio (play/pause) via control
    toggle.addEventListener('click', (e)=>{
      e.stopPropagation();
      if(bg.paused){ bg.play().then(()=>{ toggle.textContent='ðŸ”Š'; }).catch(()=>{ toggle.textContent='ðŸ”ˆ'; }); }
      else { bg.pause(); toggle.textContent='ðŸ”‡'; }
    });

    startBtn.addEventListener('click', ()=>{
      // reset scores and lifelines for a fresh game
      localStorage.setItem('scoreR1', '0');
      localStorage.setItem('scoreR2', '0');
      localStorage.setItem('scoreR3', '0');
      // reset global lifelines (single-use across the full game)
      localStorage.setItem('lifelines_global', JSON.stringify({"50-50":false,"phone":false,"poll":false}));
      // clear any stored question orders so new shuffle occurs
      localStorage.removeItem('order_R1');
      localStorage.removeItem('order_R2');
      localStorage.removeItem('order_R3');
      // stop audio before navigating
      try{ bg.pause(); bg.currentTime = 0; }catch(e){}
      window.location.href = 'round1.html';
    });

    // attempt autoplay immediately on DOMContentLoaded and on load
    document.addEventListener('DOMContentLoaded', tryPlay, {once:true});
    window.addEventListener('load', tryPlay);
  </script>
</body>
</html>
